<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>じょいのブログ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="blog.css">
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=M+PLUS+1p&display=swap" rel="stylesheet">
</head>
<body>
  <header>
    <h1 class="blog-title">じょいのブログ</h1>
  </header>

  <div class="container">
    <aside class="sidebar">
      <h2>アーカイブ</h2>
      <ul id="archiveList">
        <!-- JavaScriptで投稿日付を一覧表示 -->
      </ul>
    </aside>

    <main class="content">
      <section id="postList">
        <!-- JavaScriptで投稿内容を表示 -->
      </section>
    </main>
  </div>

  <footer>
    <div class="back-link">
      <a href="joy.html">← じょいの詳細ページに戻る</a>
    </div>
    <p class="copyright">&copy; 2025 Summer Gate</p>
  </footer>

  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm'

    const supabase = createClient(
      'https://neigpzmxbmsjgwbvuwnq.supabase.co',
      'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5laWdwem14Ym1zamd3YnZ1d25xIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc1OTAzNDgsImV4cCI6MjA3MzE2NjM0OH0.vuSMa_CvbD4B5NHC-STnSP6fNUkMmD2rBo4gag1gXfg'
    )

    const { data, error } = await supabase
      .from('blogs')
      .select('title, date, post, media_url')
      .order('date', { ascending: false })

    if (error) {
      console.error('読み込みエラー:', error.message)
    } else {
      const postList = document.getElementById('postList')
      const archiveList = document.getElementById('archiveList')

      data.forEach(entry => {
        // 投稿表示
        const article = document.createElement('article')
        article.className = 'post-entry'
        article.innerHTML = `
          <h2>${entry.title}</h2>
          <p class="date">${entry.date}</p>
          <p class="post">${entry.post}</p>
          ${entry.media_url ? `<img src="${entry.media_url}" alt="メディア" class="media">` : ''}
        `
        postList.appendChild(article)

        // アーカイブ表示
        const archiveItem = document.createElement('li')
        archiveItem.textContent = entry.date
        archiveList.appendChild(archiveItem)
      })
    }
  </script>
</body>
</html>